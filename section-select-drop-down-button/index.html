<div class="multi-selectors">
  <!-- –ö–Ω–æ–ø–∫–∞ 1: SELECT TOUR —Å –∏–∫–æ–Ω–∫–∞–º–∏ -->
  <div class="selector" data-name="tour">
    <button class="dropbtn" aria-haspopup="listbox" aria-expanded="false">
      <span class="icon-left">üèñÔ∏è</span>
      <span class="btn-text">SELECT TOUR</span>
      <span class="icon-right">‚ñº</span>
    </button>
    <div class="dropdown" role="listbox" tabindex="-1">
      <div class="option" role="option" data-value="Basic">Basic</div>
      <div class="option" role="option" data-value="Premium">Premium</div>
      <div class="option" role="option" data-value="Luxury">Luxury</div>
    </div>
  </div>

  <!-- –ö–Ω–æ–ø–∫–∞ 2: SELECT DATE —Å –∏–∫–æ–Ω–∫–∞–º–∏ -->
  <div class="selector" data-name="date">
    <button class="dropbtn" aria-haspopup="listbox" aria-expanded="false">
      <span class="icon-left">üìÖ</span>
      <span class="btn-text">SELECT DATE</span>
      <span class="icon-right">‚ñº</span>
    </button>
    <div class="dropdown" role="listbox" tabindex="-1">
      <div class="option" role="option" data-value="29">29</div>
      <div class="option" role="option" data-value="30">30</div>
      <div class="option" role="option" data-value="31">31</div>
    </div>
  </div>

  <!-- –ö–Ω–æ–ø–∫–∞ 3: NUMBER OF QUESTS —Å –∏–∫–æ–Ω–∫–∞–º–∏ -->
  <div class="selector" data-name="quests">
    <button class="dropbtn" aria-haspopup="listbox" aria-expanded="false">
      <span class="icon-left">üë§</span>
      <span class="btn-text">NUMBER OF QUESTS</span>
      <span class="icon-right">‚ñº</span>
    </button>
    <div class="dropdown" role="listbox" tabindex="-1">
      <div class="option" role="option" data-value="1">1</div>
      <div class="option" role="option" data-value="2">2</div>
      <div class="option" role="option" data-value="3">3</div>
    </div>
  </div>

  <!-- –ö–Ω–æ–ø–∫–∞ –∫—É–ø–∏—Ç—å -->
  <button id="buyBtn" class="buy-btn">–ö—É–ø–∏—Ç—å</button>
</div>

<style>
.multi-selectors {
  display: flex;
  flex-direction: column; /* –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π —Å—Ç–µ–∫ */
  align-items: flex-start;
}

.selector {
  position: relative;
  margin-bottom: 20px; /* –æ—Ç—Å—Ç—É–ø –º–µ–∂–¥—É –¥—Ä–æ–ø–¥–∞—É–Ω–∞–º–∏ */
  min-width: 275px;
}

.multi-selectors .selector:last-of-type {
  margin-bottom: 35px; /* –æ—Ç—Å—Ç—É–ø –º–µ–∂–¥—É –ø–æ—Å–ª–µ–¥–Ω–µ–π –∫–Ω–æ–ø–∫–æ–π –∏ –∫–Ω–æ–ø–∫–æ–π –ö—É–ø–∏—Ç—å */
}

.dropbtn,
.buy-btn {
  padding: 8px 14px;
  border-radius: 6px;
  border: 1px solid #fff; /* –±–µ–ª–∞—è —Ä–∞–º–∫–∞ 1px */
  background: transparent; /* –ø—Ä–æ–∑—Ä–∞—á–Ω–∞—è –∫–Ω–æ–ø–∫–∞ */
  color: #fff; /* –±–µ–ª—ã–π —Ç–µ–∫—Å—Ç */
  cursor: pointer;
  min-width: 275px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  box-sizing: border-box;
}

.dropbtn .icon-left,
.dropbtn .icon-right {
  color: #fff; /* –±–µ–ª—ã–µ –∏–∫–æ–Ω–∫–∏ */
}

.buy-btn {
  border: 1px solid #fff; /* –±–µ–ª–∞—è —Ä–∞–º–∫–∞ */
  background: transparent; /* –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω */
  color: #fff;
}

.dropdown {
  display: none;
  position: absolute;
  top: 110%;
  left: 0;
  background: #000; /* –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —á—ë—Ä–Ω—ã–π —Ñ–æ–Ω –¥–ª—è –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ —Å–ø–∏—Å–∫–∞ */
  border: 1px solid #fff; /* –±–µ–ª–∞—è —Ä–∞–º–∫–∞ */
  box-shadow: 0 6px 18px rgba(0, 0, 0, 0.08);
  min-width: 160px;
  z-index: 50;
  border-radius: 6px;
  overflow: hidden;
}

.option {
  padding: 8px 12px;
  cursor: pointer;
  user-select: none;
  color: #fff; /* –±–µ–ª—ã–π —Ç–µ–∫—Å—Ç */
}

.option:hover,
.option[aria-selected="true"] {
  background: rgba(255, 255, 255, 0.1); /* –ª—ë–≥–∫–∏–π –±–µ–ª—ã–π —Ö–æ–≤–µ—Ä */
}

.error {
  box-shadow: 0 0 0 3px rgba(255, 0, 0, 0.12) inset;
}
</style>



<script>
(function(){
  const selectors = document.querySelectorAll('.multi-selectors .selector');
  const buyBtn = document.getElementById('buyBtn');

  selectors.forEach(sel => {
    const btn = sel.querySelector('.dropbtn');
    const list = sel.querySelector('.dropdown');
    const options = list.querySelectorAll('.option');

    btn.addEventListener('click', (e) => {
      e.stopPropagation();
      closeAllDropdownsExcept(list);
      const opened = list.style.display === 'block';
      setDropdownState(list, btn, !opened);
    });

    options.forEach(opt => {
      opt.addEventListener('click', (e) => {
        e.stopPropagation();
        options.forEach(o => o.removeAttribute('aria-selected'));
        opt.setAttribute('aria-selected', 'true');
        sel.dataset.selected = opt.dataset.value;

        // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏, –æ—Å—Ç–∞–≤–ª—è—è –∏–∫–æ–Ω–∫–∏
        const btnText = btn.querySelector('.btn-text');
        if (btnText) btnText.textContent = opt.textContent;
        else btn.textContent = opt.textContent;

        setDropdownState(list, btn, false);
      });

      opt.addEventListener('keydown', (ev) => {
        if (ev.key === 'Enter' || ev.key === ' ') opt.click();
      });
    });

    document.addEventListener('click', () => setDropdownState(list, btn, false));
  });

  function closeAllDropdownsExcept(exceptList) {
    document.querySelectorAll('.multi-selectors .dropdown').forEach(l => {
      if (l !== exceptList) {
        const btn = l.parentElement.querySelector('.dropbtn');
        setDropdownState(l, btn, false);
      }
    });
  }

  function setDropdownState(listEl, btnEl, open) {
    listEl.style.display = open ? 'block' : 'none';
    btnEl.setAttribute('aria-expanded', open ? 'true' : 'false');
  }

  buyBtn.addEventListener('click', () => {
    const payload = {};
    let ok = true;

    selectors.forEach(sel => {
      const name = sel.dataset.name || sel.getAttribute('id') || 'unknown';
      const val = sel.dataset.selected || null;
      if (!val) {
        ok = false;
        sel.querySelector('.dropbtn').classList.add('error');
        setTimeout(()=> sel.querySelector('.dropbtn').classList.remove('error'), 1500);
      } else {
        payload[name] = val;
      }
    });

    if (!ok) {
      alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –≤—Å–µ –æ–ø—Ü–∏–∏.');
      return;
    }

    const params = new URLSearchParams(payload).toString();
    const buyUrl = '/buy?' + params;
    window.location.href = buyUrl;
  });

})();
</script>
